(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"./src/workbench/Workbench.tsx":function(e,t,a){"use strict";a.r(t);var n,r=a("./node_modules/react/index.js"),l=a.n(r),o=a("./node_modules/@material-ui/core/styles/index.js"),s=a("./node_modules/react-router-dom/es/Link.js"),i=a("./node_modules/@material-ui/core/Paper/index.js"),c=a.n(i),d=a("./node_modules/@material-ui/core/Toolbar/index.js"),m=a.n(d),u=a("./node_modules/@material-ui/core/Button/index.js"),p=a.n(u),h=a("./node_modules/@material-ui/icons/RestorePage.js"),g=a.n(h),b=a("./node_modules/@material-ui/icons/Save.js"),C=a.n(b),E=a("./node_modules/@material-ui/icons/Share.js"),y=a.n(E),v=a("./node_modules/@material-ui/icons/Undo.js"),S=a.n(v),I=a("./node_modules/@material-ui/icons/Redo.js"),f=a.n(I),w=a("./node_modules/@material-ui/icons/OpenWith.js"),x=a.n(w),j=a("./node_modules/@material-ui/icons/ArrowDownward.js"),T=a.n(j);!function(e){e.NOTSPECIFIED="NotSpecified",e.TEXTVALUE="TextValue",e.BOOLVALUE="BoolValue",e.INTERVALVALUE="Interval",e.INTVALUE="IntValue",e.DOUBLEVALUE="DoubleValue",e.TEXTVALUEWITHLABEL="TextValueWithLabel",e.TEXTVALUEWITHMASK="TextValueWithMask",e.TEXTVALUEWITHORDER="TextValueWithOrder",e.SELECT="Select",e.TEXTINPUTLIST="TextInputList",e.MULTISELECT="MultiSelect"}(n||(n={}));const O=[{id:0,label:"New",IconComponent:g.a},{id:1,label:"Save",IconComponent:C.a},{id:2,label:"Save As",IconComponent:C.a},{id:3,label:"Share",IconComponent:y.a},{id:4,label:"Undo",IconComponent:S.a},{id:5,label:"Redo",IconComponent:f.a},{id:6,label:"Layout",IconComponent:x.a},{id:7,label:"Export Graph",IconComponent:T.a}];const k=({className:e,children:t})=>l.a.createElement(s.a,{className:e,to:"/workbench/new"},t);var N=Object(o.withStyles)(({spacing:e})=>Object(o.createStyles)({root:{position:"absolute",right:0,marginRight:10,marginTop:10,zIndex:1},toolBar:{minHeight:0},leftIcon:{fill:"#bdbdbd",marginRight:e.unit}}))(({classes:e})=>l.a.createElement(c.a,{className:e.root},l.a.createElement(m.a,{className:e.toolBar,disableGutters:!0},O.map(({id:t,label:a,IconComponent:n})=>l.a.createElement(p.a,{key:t,size:"small",component:k},l.a.createElement(n,{className:e.leftIcon}),a))))),L=a("./node_modules/react-redux/es/index.js"),R=a("./node_modules/reselect/lib/index.js"),D=a("./src/sidebar/operators/operatorsData.ts");const A=Object(R.createSelector)(e=>e.configSwitchReducer.elementType,e=>e!==D.b.NONE);var V=a("./node_modules/@material-ui/core/Grid/index.js"),Q=a.n(V),_=a("./node_modules/@material-ui/core/Drawer/index.js"),P=a.n(_);const U=Object(R.createSelector)(e=>e.queryConfigReducer.dataServices,e=>e.map(({ItemId:e,Label:t})=>({value:e,label:t})).sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),M=e=>e.queryConfigReducer.elementId,F=e=>e.sessionReducer.queries,q=e=>e.queryConfigReducer.availableColumns,W=Object(R.createSelector)(M,F,q,(e,t,a)=>a.filter(a=>!t[e].Columns.map(e=>e.ColumnName).includes(a.ColumnName))),B=Object(R.createSelector)(M,F,(e,t)=>t[e]),z=Object(R.createSelector)(M,F,(e,t)=>t[e].Columns),H=Object(R.createSelector)(M,F,(e,t)=>{const a=t[e];return a.Columns.length>0?[!0,!0,!0,!1]:a.TargetDataViewId?[!0,!1]:[!1]}),G=["DateTimeValue","DateValue","TimeValue"],X=Object(R.createSelector)(q,e=>e.queryConfigReducer.availableFilters,M,F,(e,t,a,n)=>{const r=t.map(({Label:e,FilterName:t,DataType:a,ToColumnName:n})=>({value:{key:t,label:e,dataType:a,toColumnName:n},label:e+" (F)"})),l=e.filter(({DataType:e})=>!G.includes(e)).filter(({ColumnName:e})=>!t.some(({ToColumnName:t})=>null!=t&&t===e)).map(({Label:e,ColumnName:t,DataType:a})=>({value:{key:t,label:e,dataType:a},label:e}));return r.concat(l).filter(e=>!n[a].Constraints.some(t=>e.value.key===t.FilterName||e.value.key===t.ColumnName))}),Y=Object(R.createSelector)(M,F,(e,t)=>t[e].Constraints.map(e=>(function(e){const t=Object.assign({label:e.ColumnName,value:""},e);switch(e.DataType){case n.INTERVALVALUE:t.value=e.Values&&{intervalType:e.Values[0][0],intervalString:e.Values[0][1],intervalLabel:e.Values[0][2]};break;case n.TEXTVALUE:case n.TEXTVALUEWITHLABEL:case n.TEXTVALUEWITHMASK:case n.TEXTVALUEWITHORDER:case n.BOOLVALUE:case n.INTVALUE:case n.DOUBLEVALUE:t.value=e.Values?e.Values[0][0]:"";break;default:t.value=""}return t})(e)));var $=a("./src/common/loading/index.ts"),K=a("./node_modules/@material-ui/core/Card/index.js"),J=a.n(K),Z=a("./node_modules/@material-ui/core/CardHeader/index.js"),ee=a.n(Z),te=a("./node_modules/@material-ui/core/Avatar/index.js"),ae=a.n(te),ne=a("./node_modules/@material-ui/icons/InfoOutlined.js"),re=a.n(ne);var le=({currentStep:e})=>{let t="",a="";switch(e){case 0:t="Query source",a="Select from the drop down the source of your query.\n        It can be a data source or an existing query.\n        Once you are done go to the next step clicking on the next button.";break;case 1:t="Query columns",a="Each source presents a list of available columns.\n        You can search for a particular column using the search input.\n        Click on a column on the available list to move it to the selected list.\n        To remove a column from the selected list click on it again.";break;case 2:t="Query Constraints",a="Narrow down your data with constraints.\n        Constraints are part of the query you are creating and are not visible outside of it.";break;default:return null}return l.a.createElement(Q.a,{item:!0,xs:12},l.a.createElement(J.a,null,l.a.createElement(ee.a,{avatar:l.a.createElement(ae.a,null,l.a.createElement(re.a,null)),title:t,subheader:a})))},oe=a("./src/workbench/query/actions.ts"),se=a("./node_modules/@material-ui/core/Typography/index.js"),ie=a.n(se),ce=a("./node_modules/@material-ui/core/Stepper/index.js"),de=a.n(ce),me=a("./node_modules/@material-ui/core/Step/index.js"),ue=a.n(me),pe=a("./node_modules/@material-ui/core/StepButton/index.js"),he=a.n(pe);var ge=Object(o.withStyles)(({spacing:e})=>Object(o.createStyles)({gridTitle:{position:"fixed",width:"99%",backgroundColor:"white",zIndex:2,borderBottom:"1px solid #eee"},titleContainer:{display:"flex",alignItems:"center",marginBottom:2*e.unit},title:{marginRight:2*e.unit},stepper:{padding:0,width:"100%"},stepTitle:{marginTop:85}}))(({classes:e,title:t,stepLabels:a,currentStep:n,completedSteps:o,dispatchGoToStep:s})=>{return l.a.createElement(r.Fragment,null,l.a.createElement(Q.a,{item:!0,xs:12,className:e.gridTitle},l.a.createElement("div",{className:e.titleContainer},l.a.createElement(ie.a,{variant:"title",className:e.title},t)),l.a.createElement(de.a,{classes:{root:e.stepper},nonLinear:!0,activeStep:n},a.map((e,t)=>l.a.createElement(ue.a,{key:e},l.a.createElement(he.a,{onClick:(e=>()=>s(e))(t),disabled:null==o[t],completed:o[t]},e))))),l.a.createElement(Q.a,{item:!0,xs:12,className:e.stepTitle},l.a.createElement(ie.a,{variant:"headline"},`Step ${n+1}: ${a[n]}`)))});const be=["Source","Columns","Constraints","Summary"];var Ce=Object(L.connect)(null,e=>({dispatchGoToStep:t=>e(Object(oe.j)(t))}))(class extends r.Component{render(){const{currentStep:e,completedSteps:t,dispatchGoToStep:a}=this.props;return l.a.createElement(ge,{title:"Configure Query",stepLabels:be,currentStep:e,completedSteps:t,dispatchGoToStep:a})}}),Ee=a("./src/workbench/actions.ts"),ye=a("./node_modules/react-virtualized/dist/es/index.js"),ve=a("./node_modules/@material-ui/core/FormControl/index.js"),Se=a.n(ve),Ie=a("./node_modules/@material-ui/core/Input/index.js"),fe=a.n(Ie),we=a("./node_modules/@material-ui/core/Menu/index.js"),xe=a.n(we),je=a("./node_modules/@material-ui/core/InputLabel/index.js"),Te=a.n(je),Oe=a("./node_modules/@material-ui/core/FormHelperText/index.js"),ke=a.n(Oe),Ne=a("./node_modules/@material-ui/core/InputAdornment/index.js"),Le=a.n(Ne),Re=a("./node_modules/@material-ui/core/IconButton/index.js"),De=a.n(Re),Ae=a("./node_modules/@material-ui/core/MenuItem/index.js"),Ve=a.n(Ae),Qe=a("./node_modules/@material-ui/core/ListItemIcon/index.js"),_e=a.n(Qe);var Pe=Object(o.withStyles)(({spacing:{unit:e}})=>Object(o.createStyles)({menuItem:{padding:"0 0 0 10px"},labelContainer:{padding:2*e}}))(({classes:e,style:t,OptionsIcon:a,option:n,handleClick:r})=>l.a.createElement(Ve.a,{component:"div",style:t,className:e.menuItem,onClick:r},a&&l.a.createElement(_e.a,null,l.a.createElement(a,null)),l.a.createElement("div",{className:e.labelContainer},n.label)));var Ue=Object(o.withStyles)(({spacing:{unit:e}})=>Object(o.createStyles)({labelContainer:{padding:2*e}}))(({classes:e})=>l.a.createElement(ie.a,{color:"textSecondary",className:e.labelContainer},"No items found")),Me=a("./node_modules/@material-ui/icons/Clear.js"),Fe=a.n(Me);const qe=()=>l.a.createElement(Ue,null);var We=({containerRef:e,inputLabel:t,helperText:a,label:n,options:r,handleInputClick:o,handleInputChange:s,noClear:i,handleClickClearSelected:c,handleMouseDownPassword:d,anchorEl:m,handleClose:u,handleOptionClick:p,OptionsIcon:h})=>l.a.createElement("div",{ref:e},l.a.createElement(Se.a,{fullWidth:!0},t&&l.a.createElement(Te.a,{htmlFor:"select-input"},t),l.a.createElement(fe.a,{fullWidth:!0,value:n,onClick:o,onChange:s,endAdornment:!i&&l.a.createElement(Le.a,{position:"end"},l.a.createElement(De.a,{"aria-label":"Clear Selected",onClick:c,onMouseDown:d},l.a.createElement(Fe.a,null)))}),l.a.createElement(xe.a,{disableAutoFocus:!0,disableAutoFocusItem:!0,disableRestoreFocus:!0,MenuListProps:{component:"div",disablePadding:!0},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},anchorEl:m,open:!!m,onClose:u},e.current&&l.a.createElement(ye.b,{width:e.current.offsetWidth,height:0===r.length?45:Math.min(40*r.length,300),rowCount:r.length,rowHeight:40,rowRenderer:((e,t,a)=>({index:n,key:r,style:o})=>{const s=e[n],i=t(s);return l.a.createElement(Pe,{key:r,style:o,option:s,handleClick:i,OptionsIcon:a})})(r,p,h),noRowsRenderer:qe})),a&&l.a.createElement(ke.a,null,a)));class Be extends l.a.Component{constructor(e){super(e),this.containerRef=l.a.createRef(),this.handleMouseDownPassword=(e=>{e.preventDefault()}),this.handleClickClearSelected=(()=>{this.setState({options:[...this.props.options],label:"",anchorEl:void 0})}),this.handleInputClick=(e=>{this.setState({options:[...this.props.options],anchorEl:e.currentTarget})}),this.handleInputChange=(e=>{this.setState({options:this.props.options.filter(({label:t})=>t.toUpperCase().includes(e.target.value.toUpperCase())),label:e.target.value})}),this.handleOptionClick=(e=>t=>{this.setState({label:e.label,anchorEl:void 0}),this.props.handleChange(e)}),this.handleClose=(()=>{this.setState({anchorEl:void 0})});const t=e.value&&this.props.options.find(({value:t})=>"string"==typeof t&&t===e.value);this.state={anchorEl:void 0,label:t&&t.label||"",options:[...this.props.options]}}render(){const{OptionsIcon:e,inputLabel:t,helperText:a,noClear:n}=this.props,{anchorEl:r,label:o,options:s}=this.state;return l.a.createElement(We,{label:o,containerRef:this.containerRef,anchorEl:r,options:s,handleOptionClick:this.handleOptionClick,handleInputClick:this.handleInputClick,handleInputChange:this.handleInputChange,handleClickClearSelected:this.handleClickClearSelected,handleMouseDownPassword:this.handleMouseDownPassword,handleClose:this.handleClose,OptionsIcon:e,inputLabel:t,helperText:a,noClear:n})}}var ze=a("./node_modules/@material-ui/icons/Storage.js"),He=a.n(ze);const Ge=Object(o.createStyles)({iconColour:{fill:"#003b86"}}),Xe=Object(o.withStyles)(Ge)(({classes:e})=>l.a.createElement(He.a,{className:e.iconColour}));var Ye=({targetDataViewId:e,dataServices:t,handleChangeDataService:a})=>l.a.createElement(Be,{OptionsIcon:Xe,inputLabel:"Click here to select a source...",value:e,options:t,handleChange:a});var $e=Object(L.connect)(e=>({dataServices:U(e)}),e=>({dispatchDataServicesRequest:()=>e(Object(oe.f)()),dispatchUpdateDataService:(t,a)=>e(Object(Ee.r)(t,a))}))(class extends r.Component{constructor(){super(...arguments),this.handleChangeDataService=(e=>{const{elementId:t,dispatchUpdateDataService:a}=this.props;a(t,e.value)})}componentDidMount(){this.props.dispatchDataServicesRequest()}render(){const{targetDataViewId:e,dataServices:t}=this.props;return l.a.createElement(Ye,{targetDataViewId:e,dataServices:t,handleChangeDataService:this.handleChangeDataService})}}),Ke=a("./node_modules/@material-ui/core/List/index.js"),Je=a.n(Ke),Ze=a("./node_modules/@material-ui/core/ListItem/index.js"),et=a.n(Ze),tt=a("./node_modules/@material-ui/core/ListItemText/index.js"),at=a.n(tt),nt=a("./node_modules/@material-ui/icons/SettingsApplications.js"),rt=a.n(nt);const lt=Object(o.createStyles)({iconColour:{fill:"#003b86"},listItem:{paddingLeft:15},listItemText:{display:"flex"},listItemTextPrimary:{flexBasis:"35%"}});var ot=Object(o.withStyles)(lt)(({classes:e,style:t,option:a,handleClick:n})=>l.a.createElement(et.a,{divider:!0,style:t,onClick:n,disableGutters:!0,dense:!0,button:!0,className:e.listItem,ContainerComponent:"div"},l.a.createElement(_e.a,null,l.a.createElement(rt.a,{className:e.iconColour})),l.a.createElement(at.a,{classes:{primary:e.listItemTextPrimary},className:e.listItemText,primary:a.label})));const st=Object(o.createStyles)({list:{height:"100%"},paper:{padding:10}}),it=()=>l.a.createElement(Ue,null);var ct=Object(o.withStyles)(st)(({classes:e,label:t,totItems:a,searchableItems:n,searchString:r,handleItemClick:o,handleChange:s,handleClickClearIcon:i})=>l.a.createElement(c.a,{className:e.paper},l.a.createElement(ie.a,{variant:"subheading"},`${t} (${a})`),l.a.createElement(Je.a,{className:e.list,component:"div",disablePadding:!0},l.a.createElement(Se.a,{fullWidth:!0},l.a.createElement(Te.a,null,"Search"),l.a.createElement(fe.a,{value:r,onChange:s,disabled:0===n.length,endAdornment:l.a.createElement(Le.a,{position:"end"},l.a.createElement(De.a,{"aria-label":"Clear",onClick:i,onMouseDown:i},r?l.a.createElement(Fe.a,null):null))})),l.a.createElement(ye.a,{disableHeight:!0},({width:e})=>l.a.createElement(ye.b,{width:e,height:245,rowCount:n.length,rowHeight:41,rowRenderer:((e,t)=>({index:a,key:n,style:r})=>{const o=e[a],s=t(o);return l.a.createElement(ot,{key:n,style:r,option:o,handleClick:s})})(n,o),noRowsRenderer:it})))));const dt=e=>e.searchString,mt=(e,t)=>t.items;class ut extends r.Component{constructor(){super(...arguments),this.state={searchString:""},this.filterList=Object(R.createSelector)(dt,mt,(e,t)=>t.filter(t=>t.label.includes(e))),this.handleClickClearIcon=(()=>{this.setState({searchString:""})}),this.handleChange=(e=>{this.setState({searchString:e.target.value})})}render(){const{label:e,handleItemClick:t}=this.props,{searchString:a}=this.state,n=this.filterList(this.state,this.props);return l.a.createElement(ct,{label:e,totItems:n.length,searchableItems:n,searchString:a,handleItemClick:t,handleChange:this.handleChange,handleClickClearIcon:this.handleClickClearIcon})}}var pt=a("./node_modules/@material-ui/icons/KeyboardArrowLeft.js"),ht=a.n(pt),gt=a("./node_modules/@material-ui/icons/KeyboardArrowRight.js"),bt=a.n(gt);var Ct=Object(o.withStyles)(({spacing:{unit:e}})=>Object(o.createStyles)({listContainer:{position:"relative"},button:{position:"absolute",right:2*e,top:2*e}}))(({classes:e,availableColumns:t,selectedColumns:a,handleAddQueryColumn:n,handleRemoveQueryColumn:r})=>l.a.createElement(Q.a,{container:!0,spacing:16},l.a.createElement(Q.a,{item:!0,xs:6,className:e.listContainer},t.length>0&&l.a.createElement(p.a,{variant:"outlined",color:"secondary",size:"small",className:e.button},"Add All Columns",l.a.createElement(bt.a,null)),l.a.createElement(ut,{label:"Available Columns",items:t,handleItemClick:n})),l.a.createElement(Q.a,{item:!0,xs:6,className:e.listContainer},a.length>0&&l.a.createElement(p.a,{variant:"outlined",size:"small",className:e.button},l.a.createElement(ht.a,null),"Remove All Columns"),l.a.createElement(ut,{label:"Selected Columns",items:a,handleItemClick:r}))));const Et=e=>e.availableColumns,yt=e=>e.selectedColumns;var vt=Object(L.connect)(e=>({availableColumns:W(e),selectedColumns:z(e)}),e=>({dispatchAddQueryColumn:(t,a)=>e(Object(Ee.h)(t,a)),dispatchRemoveQueryColumn:(t,a)=>e(Object(Ee.l)(t,a))}))(class extends r.Component{constructor(){super(...arguments),this.availableColumnOptions=Object(R.createSelector)(Et,e=>e.map(e=>({label:e.Label,value:e.ColumnName}))),this.selectedColumnOptions=Object(R.createSelector)(yt,e=>e.map(e=>({label:e.Label,value:e.ColumnName}))),this.handleAddQueryColumn=(({value:e,label:t})=>a=>{const{elementId:n,dispatchAddQueryColumn:r}=this.props;r(n,{ColumnName:e,Label:t,Aggregation:"None"})}),this.handleRemoveQueryColumn=(({value:e})=>t=>{const{elementId:a,dispatchRemoveQueryColumn:n}=this.props;n(a,e)})}render(){return l.a.createElement(Ct,{availableColumns:this.availableColumnOptions(this.props),selectedColumns:this.selectedColumnOptions(this.props),handleAddQueryColumn:this.handleAddQueryColumn,handleRemoveQueryColumn:this.handleRemoveQueryColumn})}}),St=a("./node_modules/@material-ui/core/Select/index.js"),It=a.n(St),ft=a("./node_modules/@material-ui/icons/FilterList.js"),wt=a.n(ft),xt=a("./node_modules/@material-ui/icons/Delete.js"),jt=a.n(xt);var Tt=Object(o.withStyles)(({spacing:{unit:e}})=>Object(o.createStyles)({constraintTargetSelect:{marginBottom:30},constraintIconColour:{fill:"#2c5367"},paper:{display:"flex",alignItems:"center"},targetLabel:{flexBasis:`${2*e}%`,margin:e},typeSelect:{flexBasis:`${2*e}%`,margin:e},valueInput:{flexGrow:1,margin:e},constraintIcon:{margin:e,fill:"#2c5367"}}))(({classes:e,contraintTargets:t,queryConstraints:a,filterCapabilities:n,handledAddQueryConstraint:o,handledUpdateQueryConstraintType:s,handledUpdateQueryConstraintValues:i,handledRemoveQueryConstraint:d})=>l.a.createElement(r.Fragment,null,l.a.createElement("div",{className:e.constraintTargetSelect},l.a.createElement(Be,{OptionsIcon:wt.a,inputLabel:"Contraint on...",options:t,handleChange:o})),a.length>0&&a.map(({ConstraintId:t,DataType:a,FilterType:r,value:o,label:m})=>l.a.createElement(c.a,{key:t,className:e.paper},l.a.createElement(wt.a,{className:e.constraintIcon}),l.a.createElement(ie.a,{variant:"subheading",className:e.targetLabel},m),l.a.createElement(Se.a,{className:e.typeSelect},l.a.createElement(It.a,{value:r,onChange:s(t),autoWidth:!0},n[a].map(({Type:e,Label:t},a)=>l.a.createElement(Ve.a,{key:a,value:e},t)))),l.a.createElement(Se.a,{className:e.valueInput},l.a.createElement(fe.a,{autoFocus:!0,value:o,onChange:i(t,a)})),l.a.createElement(De.a,{"aria-label":"Delete",onClick:d(t)},l.a.createElement(jt.a,null))))));var Ot=Object(L.connect)(e=>({queryConstraints:Y(e),filterCapabilities:e.queryConfigReducer.filterCapabilities,contraintTargets:X(e)}),e=>({dispatchFilterCapabilitiesRequest:()=>e(Object(oe.h)()),dispatchAddQueryConstraint:(t,a)=>e(Object(Ee.i)(t,a)),dispatchUpdateQueryConstraintType:(t,a,n)=>e(Object(Ee.p)(t,a,n)),dispatchUpdateQueryConstraintValues:(t,a,n)=>e(Object(Ee.q)(t,a,n)),dispatchRemoveQueryConstraint:(t,a)=>e(Object(Ee.m)(t,a))}))(class extends r.Component{constructor(){super(...arguments),this.handledAddQueryConstraint=(e=>{const{elementId:t,queryConstraints:a,dispatchAddQueryConstraint:n,filterCapabilities:r}=this.props;n(t,{ConstraintId:a.length,ConstraintName:e.value.key,FilterName:e.value.key,DataType:e.value.dataType,ColumnName:e.value.key,FilterType:r[e.value.dataType][0].Type})}),this.handledUpdateQueryConstraintType=(e=>t=>{const{elementId:a,dispatchUpdateQueryConstraintType:n}=this.props;n(a,e,t.target.value)}),this.handledUpdateQueryConstraintValues=((e,t)=>a=>{const{elementId:r,dispatchUpdateQueryConstraintValues:l}=this.props,o=function(e,t,a){const r={vectorValues:[[t]],valuesHint:"NoHint"};switch(e){case n.INTERVALVALUE:r.vectorValues=[[t.intervalType,t.intervalString,t.intervalLabel]];break;case n.SELECT:case n.TEXTINPUTLIST:case n.MULTISELECT:r.vectorValues=t.values,r.valuesHint=a}return r}(t,a.target.value);l(r,e,o.vectorValues)}),this.handledRemoveQueryConstraint=(e=>()=>{const{elementId:t,dispatchRemoveQueryConstraint:a}=this.props;a(t,e)})}componentDidMount(){this.props.dispatchFilterCapabilitiesRequest()}render(){const{queryConstraints:e,filterCapabilities:t,contraintTargets:a}=this.props;return l.a.createElement(Tt,{queryConstraints:e,filterCapabilities:t,contraintTargets:a,handledAddQueryConstraint:this.handledAddQueryConstraint,handledUpdateQueryConstraintType:this.handledUpdateQueryConstraintType,handledUpdateQueryConstraintValues:this.handledUpdateQueryConstraintValues,handledRemoveQueryConstraint:this.handledRemoveQueryConstraint})}});var kt=Object(o.withStyles)(({spacing:{unit:e}})=>Object(o.createStyles)({actionButtons:{display:"flex",justifyContent:"flex-end",position:"fixed",bottom:6*e,right:0},button:{margin:e}}))(({classes:e,currentStep:t,completedSteps:a,dispatchCloseConfig:n,dispatchGoToStep:r})=>{const o=e=>()=>r(e);return l.a.createElement(Q.a,{item:!0,xs:12,className:e.actionButtons},l.a.createElement(p.a,{onClick:n,variant:"raised",className:e.button},"Close"),l.a.createElement(p.a,{disabled:0===t,onClick:o(t-1),variant:"raised",color:"secondary",className:e.button},"Back"),l.a.createElement(p.a,{disabled:!a[t],onClick:o(t+1),variant:"raised",color:"secondary",className:e.button},"Next"))});var Nt=Object(L.connect)(null,e=>({dispatchGoToStep:t=>e(Object(oe.j)(t)),dispatchCloseQueryConfig:()=>e(Object(oe.e)())}))(class extends r.Component{render(){const{currentStep:e,completedSteps:t,dispatchCloseQueryConfig:a,dispatchGoToStep:n}=this.props;return l.a.createElement(kt,{currentStep:e,completedSteps:t,dispatchCloseConfig:a,dispatchGoToStep:n})}});var Lt=({isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n})=>l.a.createElement($.a,{isLoading:e},l.a.createElement(Ce,{currentStep:a,completedSteps:n}),l.a.createElement(le,{currentStep:a}),l.a.createElement(Q.a,{item:!0,xs:12},function(e,t){if(null==t.TargetDataViewId)throw new Error("TargetDataViewId cannot be null.");switch(e){case 0:return l.a.createElement($e,{elementId:t.ElementId,targetDataViewId:t.TargetDataViewId});case 1:return l.a.createElement(vt,{elementId:t.ElementId});case 2:return l.a.createElement(Ot,{elementId:t.ElementId});default:return"Unknown step"}}(a,t)),l.a.createElement(Nt,{currentStep:a,completedSteps:n}));var Rt=Object(L.connect)(e=>({isLoading:e.queryConfigReducer.isLoading,selectedQuery:B(e),currentStep:e.queryConfigReducer.currentStep,completedSteps:H(e)}))(class extends r.Component{render(){const{isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n}=this.props;return l.a.createElement(Lt,{isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n})}});var Dt=Object(o.withStyles)(({spacing:e})=>Object(o.createStyles)({paper:{width:"85%",marginTop:48},form:{position:"relative",height:"100%",padding:2*e.unit,overflow:"auto",marginBottom:48}}))(({classes:e,elementType:t,isDrawerOpen:a})=>l.a.createElement(P.a,{classes:{paper:e.paper},anchor:"right",open:a},a&&l.a.createElement("form",{className:e.form,noValidate:!0,autoComplete:"off"},l.a.createElement(Q.a,{container:!0,spacing:16,alignContent:"stretch"},(e=>{switch(e){case D.b.QUERY:return l.a.createElement(Rt,null);case D.b.FILTER:return"TODO";default:return null}})(t)))));var At=Object(L.connect)(e=>({elementType:e.configSwitchReducer.elementType,isDrawerOpen:A(e)}))(class extends r.Component{render(){return l.a.createElement(Dt,Object.assign({},this.props))}}),Vt=(a("./node_modules/storm-react-diagrams/dist/style.min.css"),a("./node_modules/storm-react-diagrams/dist/main.js"));class Qt extends Vt.AbstractPortFactory{constructor(e){super("workbench"),this.portModel=e}getNewInstance(e){return this.portModel}}class _t extends Vt.PortModel{constructor(e="from"){super(e,"workbench"),this.position=e}serialize(){return Object.assign(super.serialize(),{position:this.position})}deSerialize(e,t){super.deSerialize(e,t),this.position=e.position}link(e){const t=this.createLinkModel();return t.setSourcePort(this),t.setTargetPort(e),t}createLinkModel(){return new Vt.DefaultLinkModel}}const Pt=Object(o.createStyles)({listItem:{padding:0},itemIcon:{width:10,height:10,marginRight:5},primary:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});var Ut=Object(o.withStyles)(Pt)(({classes:e,style:t,label:a})=>l.a.createElement(et.a,{style:t,className:e.listItem,component:"div",dense:!0},l.a.createElement(_e.a,{className:e.itemIcon},l.a.createElement(rt.a,null)),l.a.createElement(at.a,{className:e.listItem,classes:{primary:e.primary},primary:a}))),Mt=a("./node_modules/@material-ui/core/Divider/index.js"),Ft=a.n(Mt);const qt=e=>{e.stopPropagation()};var Wt=Object(o.withStyles)(({palette:{background:{paper:e}}})=>Object(o.createStyles)({container:{display:"flex",alignItems:"center",justifyContent:"center"},operatorContainer:{display:"flex",flexFlow:"column",alignItems:"center",borderRadius:5,border:"1px solid #7b582d",padding:"0px 5px 0px 5px",width:165,backgroundColor:e},titleContainer:{width:"100%",display:"flex",alignItems:"center",marginBottom:5},avatar:{marginRight:10,width:25,height:25},list:{overflow:"auto",padding:0,width:150,"&:focus":{outline:0}},listItem:{padding:0},itemIcon:{width:10,height:10,marginRight:5},primary:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},topPort:{position:"relative",top:-9,backgroundColor:"#ccc",zIndex:-1},bottomPort:{position:"relative",top:9,backgroundColor:"#ccc",borderRadius:15,zIndex:-1}}))(({classes:e,node:t})=>{const{Label:a,Columns:n}=t.getQueryInfo(),{backgroundColor:r,IconComponent:o}=D.c.QUERY;return l.a.createElement("div",{className:e.container},l.a.createElement("div",{className:e.operatorContainer},l.a.createElement("div",{className:e.topPort},l.a.createElement(Vt.PortWidget,{name:"to",node:t})),l.a.createElement("div",{className:e.titleContainer},l.a.createElement(ae.a,{className:e.avatar,style:{backgroundColor:r}},l.a.createElement(o)),l.a.createElement(ie.a,{variant:"subheading",noWrap:!0},a)),l.a.createElement("div",null,l.a.createElement(ie.a,{variant:"body2",noWrap:!0},"Columns"),l.a.createElement(Ft.a,null),l.a.createElement(Je.a,{className:e.list,onWheel:qt,component:"div"},l.a.createElement(ye.a,{disableHeight:!0},({width:e})=>l.a.createElement(ye.b,{style:{outline:0},width:e,height:Math.min(20*n.length,150),rowCount:n.length,rowHeight:20,rowRenderer:(e=>({index:t,key:a,style:n})=>l.a.createElement(Ut,{key:a,style:n,label:e[t].Label}))(n)})))),l.a.createElement("div",{className:e.bottomPort},l.a.createElement(Vt.PortWidget,{name:"from",node:t}))))});class Bt extends Vt.AbstractNodeFactory{constructor(){super("query")}generateReactWidget(e,t){return l.a.createElement(Wt,{node:t})}getNewInstance(){return new Vt.NodeModel}}class zt extends Vt.NodeModel{constructor(e){super("query",e.ElementId.toString()),this.addPort(new _t("from")),this.addPort(new _t("to")),this.setPosition(e.LayoutX,e.LayoutY),this.queryInfo=e}getQueryInfo(){return this.queryInfo}}var Ht=Object(o.withStyles)(({palette:{background:{paper:e}}})=>Object(o.createStyles)({container:{display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center",borderRadius:"0px 0px 80px 80px",border:"1px solid #2c5367",width:155,height:85,backgroundColor:e},body:{display:"flex",maxWidth:130,marginBottom:5},avatar:{width:25,height:25,marginRight:3},label:{marginTop:10},filterType:{textAlign:"center"},topPort:{position:"relative",top:-11,backgroundColor:"#ccc",zIndex:-1},bottomPort:{position:"relative",top:11,backgroundColor:"#ccc",borderRadius:15,zIndex:-1}}))(({classes:e,node:t})=>{const{Label:a,FilterType:n}=t.getFilterInfo(),{backgroundColor:r,IconComponent:o}=D.c.FILTER;return l.a.createElement("div",{className:e.container},l.a.createElement("div",{className:e.topPort},l.a.createElement(Vt.PortWidget,{name:"to",node:t})),l.a.createElement("div",{className:e.body},l.a.createElement(ae.a,{className:e.avatar,style:{backgroundColor:r}},l.a.createElement(o)),l.a.createElement(ie.a,{variant:"subheading",noWrap:!0},a)),l.a.createElement(ie.a,{className:e.filterType,variant:"body2",noWrap:!0},n),l.a.createElement("div",{className:e.bottomPort},l.a.createElement(Vt.PortWidget,{name:"from",node:t})))});class Gt extends Vt.AbstractNodeFactory{constructor(){super("filter")}generateReactWidget(e,t){return l.a.createElement(Ht,{node:t})}getNewInstance(){return new Vt.NodeModel}}class Xt extends Vt.NodeModel{constructor(e){super("filter",e.ElementId.toString()),this.addPort(new _t("from")),this.addPort(new _t("to")),this.setPosition(e.LayoutX,e.LayoutY),this.filterInfo=e}getFilterInfo(){return this.filterInfo}}const Yt=Object(o.createStyles)({canvasContainer:{height:"100%",width:"100%"},canvas:{height:"100%",width:"100%"}});var $t=Object(o.withStyles)(Yt)(({classes:e,diagramEngine:t,handleDragOver:a,handleDrop:n})=>l.a.createElement("div",{className:e.canvasContainer,onDrop:n,onDragOver:a},l.a.createElement(Vt.DiagramWidget,{className:e.canvas,diagramEngine:t,maxNumberPointsPerLink:0,allowLooseLinks:!1}))),Kt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a};var Jt=Object(L.connect)(e=>{return Kt(e.sessionReducer,[])},e=>({dispatchSessionRequest:t=>{e(Object(Ee.n)(t))},dispatchAddQuery:(t,a,n)=>e(Object(Ee.g)(t,a,n))}))(class extends r.Component{constructor(e){super(e),this.handleDragOver=(e=>{e.preventDefault()}),this.handleDrop=(e=>{const{graph:t,dispatchAddQuery:a}=this.props;if(null==t)throw new Error("Graph cannot be null.");const n=e.dataTransfer.getData("ELEMENT"),r=this.diagramEngine.getRelativeMousePoint(e);switch(n){case D.b.QUERY:a(t.NextElementId,r.x,r.y)}}),this.diagramEngine=new Vt.DiagramEngine,this.diagramEngine.installDefaultFactories(),this.diagramEngine.registerPortFactory(new Qt(new _t)),this.diagramEngine.registerNodeFactory(new Bt),this.diagramEngine.registerNodeFactory(new Gt),this.activeModel=new Vt.DiagramModel,this.diagramEngine.setDiagramModel(this.activeModel)}componentDidMount(){const{match:e}=this.props,t="new"===e.params.id?void 0:e.params.id;this.props.dispatchSessionRequest(t)}componentDidUpdate(e){const t=this.props.session;if(null==t)return;const a=e.session;if(null==a||t.SessionId!==a.SessionId){const e=Object.keys(this.props.queries).map(e=>new zt(this.props.queries[e])),t=Object.keys(this.props.filters).map(e=>new Xt(this.props.filters[e]));this.activeModel.addAll(...e),this.activeModel.addAll(...t);const a=[];for(const e of Object.keys(this.props.connections)){const t=this.props.connections[e],n=this.activeModel.getNode(t.FromElementId.toString()),r=this.activeModel.getNode(t.ToElementId.toString());if(null==n||null==r)return;const l=n.getPort("from"),o=r.getPort("to"),s=l.link(o);a.push(s)}this.activeModel.addAll(...a)}}render(){const{isLoading:e}=this.props;return l.a.createElement($.c,{isLoading:e},l.a.createElement($t,{diagramEngine:this.diagramEngine,handleDragOver:this.handleDragOver,handleDrop:this.handleDrop}))}});const Zt=Object(o.createStyles)({workbench:{height:"100%",width:"100%",border:"3px solid #ccc",backgroundColor:"#ccc"},canvasContainer:{borderRadius:5,height:"100%",width:"100%",backgroundColor:"#3c3c3c",backgroundImage:"linear-gradient(\n      0deg,\n      transparent 24%,\n      rgba(255, 255, 255, 0.05) 25%,\n      rgba(255, 255, 255, 0.05) 26%,\n      transparent 27%,\n      transparent 74%,\n      rgba(255, 255, 255, 0.05) 75%,\n      rgba(255, 255, 255, 0.05) 76%,\n      transparent 77%,\n      transparent\n    ),\n    linear-gradient(\n      90deg,\n      transparent 24%,\n      rgba(255, 255, 255, 0.05) 25%,\n      rgba(255, 255, 255, 0.05) 26%,\n      transparent 27%,\n      transparent 74%,\n      rgba(255, 255, 255, 0.05) 75%,\n      rgba(255, 255, 255, 0.05) 76%,\n      transparent 77%,\n      transparent\n    )",backgroundSize:"50px 50px"}});t.default=Object(o.withStyles)(Zt)(({classes:e,match:t})=>l.a.createElement("div",{className:e.workbench},l.a.createElement(N,null),l.a.createElement(At,null),l.a.createElement("div",{className:e.canvasContainer},l.a.createElement(Jt,{match:t}))))}}]);