(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"./src/workbench/Workbench.tsx":function(e,t,a){"use strict";a.r(t);var n,l=a("./node_modules/react/index.js"),r=a.n(l),s=a("./node_modules/@material-ui/core/styles/index.js"),o=a("./node_modules/react-router-dom/es/Link.js"),i=a("./node_modules/@material-ui/core/Paper/index.js"),c=a.n(i),d=a("./node_modules/@material-ui/core/Toolbar/index.js"),m=a.n(d),u=a("./node_modules/@material-ui/core/Button/index.js"),p=a.n(u),h=a("./node_modules/@material-ui/icons/RestorePage.js"),b=a.n(h),g=a("./node_modules/@material-ui/icons/Save.js"),C=a.n(g),E=a("./node_modules/@material-ui/icons/Share.js"),v=a.n(E),y=a("./node_modules/@material-ui/icons/Undo.js"),I=a.n(y),S=a("./node_modules/@material-ui/icons/Redo.js"),f=a.n(S),w=a("./node_modules/@material-ui/icons/OpenWith.js"),j=a.n(w),x=a("./node_modules/@material-ui/icons/ArrowDownward.js"),O=a.n(x);!function(e){e.NOTSPECIFIED="NotSpecified",e.TEXTVALUE="TextValue",e.BOOLVALUE="BoolValue",e.INTERVALVALUE="Interval",e.INTVALUE="IntValue",e.DOUBLEVALUE="DoubleValue",e.TEXTVALUEWITHLABEL="TextValueWithLabel",e.TEXTVALUEWITHMASK="TextValueWithMask",e.TEXTVALUEWITHORDER="TextValueWithOrder",e.SELECT="Select",e.TEXTINPUTLIST="TextInputList",e.MULTISELECT="MultiSelect"}(n||(n={}));const T=[{id:0,label:"New",IconComponent:b.a},{id:1,label:"Save",IconComponent:C.a},{id:2,label:"Save As",IconComponent:C.a},{id:3,label:"Share",IconComponent:v.a},{id:4,label:"Undo",IconComponent:I.a},{id:5,label:"Redo",IconComponent:f.a},{id:6,label:"Layout",IconComponent:j.a},{id:7,label:"Export Graph",IconComponent:O.a}];const N=({className:e,children:t})=>r.a.createElement(o.a,{className:e,to:"/workbench/new"},t);var k=Object(s.withStyles)(({spacing:e})=>Object(s.createStyles)({root:{position:"absolute",right:0,marginRight:10,marginTop:10,zIndex:1},toolBar:{minHeight:0},leftIcon:{fill:"#bdbdbd",marginRight:e.unit}}))(({classes:e})=>r.a.createElement(c.a,{className:e.root},r.a.createElement(m.a,{className:e.toolBar,disableGutters:!0},T.map(({id:t,label:a,IconComponent:n})=>r.a.createElement(p.a,{key:t,size:"small",component:N},r.a.createElement(n,{className:e.leftIcon}),a))))),L=a("./node_modules/react-redux/es/index.js"),D=a("./node_modules/reselect/es/index.js"),R=a("./src/sidebar/operators/operatorsData.ts");const A=Object(D.a)(e=>e.configSwitchReducer.elementType,e=>e!==R.b.NONE);var V=a("./node_modules/@material-ui/core/Grid/index.js"),Q=a.n(V),_=a("./node_modules/@material-ui/core/Drawer/index.js"),P=a.n(_);const U=Object(D.a)(e=>e.queryConfigReducer.dataServices,e=>e.map(({ItemId:e,Label:t})=>({value:e,label:t})).sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),M=e=>e.queryConfigReducer.elementId,F=e=>e.sessionReducer.queries,q=e=>e.queryConfigReducer.availableColumns,W=Object(D.a)(M,F,q,(e,t,a)=>a.filter(a=>!t[e].Columns.map(e=>e.ColumnName).includes(a.ColumnName))),B=Object(D.a)(M,F,(e,t)=>t[e]),z=Object(D.a)(M,F,(e,t)=>t[e].Columns),H=Object(D.a)(M,F,(e,t)=>{const a=t[e];return a.Columns.length>0?[!0,!0,!0,!1]:a.TargetDataViewId?[!0,!1]:[!1]}),G={DateTimeValue:!0,DateValue:!0,TimeValue:!0},X=Object(D.a)(q,e=>e.queryConfigReducer.availableFilters,M,F,(e,t,a,n)=>{const l=t.map(({Label:e,FilterName:t})=>({value:t,label:e+" (F)"})),r=t.reduce((e,t)=>(e[t.FilterName]=t,e),{}),s=e.filter(({DataType:e})=>!G[e]).filter(({ColumnName:e})=>!t.some(({ToColumnName:t})=>null!=t&&t===e)),o=s.map(({Label:e,ColumnName:t})=>({value:t,label:e+" (C)"})),i=s.reduce((e,t)=>(e[t.ColumnName]=t,e),{});return{availableConstraints:l.concat(o).filter(e=>!n[a].Constraints.some(t=>e.value===t.FilterName||e.value===t.ColumnName)),filtersDic:r,columnsDic:i}}),Y=Object(D.a)(M,F,(e,t)=>t[e].Constraints.map(e=>(function(e){const t=Object.assign({label:e.ColumnName,value:""},e);switch(e.DataType){case n.INTERVALVALUE:t.value=e.Values&&{intervalType:e.Values[0][0],intervalString:e.Values[0][1],intervalLabel:e.Values[0][2]};break;case n.TEXTVALUE:case n.TEXTVALUEWITHLABEL:case n.TEXTVALUEWITHMASK:case n.TEXTVALUEWITHORDER:case n.BOOLVALUE:case n.INTVALUE:case n.DOUBLEVALUE:t.value=e.Values?e.Values[0][0]:"";break;default:t.value=""}return t})(e)));var $=a("./src/common/loading/index.ts"),K=a("./node_modules/@material-ui/core/Card/index.js"),J=a.n(K),Z=a("./node_modules/@material-ui/core/CardHeader/index.js"),ee=a.n(Z),te=a("./node_modules/@material-ui/core/Avatar/index.js"),ae=a.n(te),ne=a("./node_modules/@material-ui/icons/InfoOutlined.js"),le=a.n(ne);var re=({currentStep:e})=>{let t="",a="";switch(e){case 0:t="Query source",a="Select from the drop down the source of your query.\n        It can be a data source or an existing query.\n        Once you are done go to the next step clicking on the next button.";break;case 1:t="Query columns",a="Each source presents a list of available columns.\n        You can search for a particular column using the search input.\n        Click on a column on the available list to move it to the selected list.\n        To remove a column from the selected list click on it again.";break;case 2:t="Query Constraints",a="Narrow down your data with constraints.\n        Constraints are part of the query you are creating and are not visible outside of it.";break;default:return null}return r.a.createElement(Q.a,{item:!0,xs:12},r.a.createElement(J.a,null,r.a.createElement(ee.a,{avatar:r.a.createElement(ae.a,null,r.a.createElement(le.a,null)),title:t,subheader:a})))},se=a("./src/workbench/query/actions.ts"),oe=a("./node_modules/@material-ui/core/Typography/index.js"),ie=a.n(oe),ce=a("./node_modules/@material-ui/core/Stepper/index.js"),de=a.n(ce),me=a("./node_modules/@material-ui/core/Step/index.js"),ue=a.n(me),pe=a("./node_modules/@material-ui/core/StepButton/index.js"),he=a.n(pe);var be=Object(s.withStyles)(({spacing:e})=>Object(s.createStyles)({gridTitle:{position:"fixed",width:"99%",backgroundColor:"white",zIndex:2,borderBottom:"1px solid #eee"},titleContainer:{display:"flex",alignItems:"center",marginBottom:2*e.unit},title:{marginRight:2*e.unit},stepper:{padding:0,width:"100%"},stepTitle:{marginTop:85}}))(({classes:e,title:t,stepLabels:a,currentStep:n,completedSteps:s,dispatchGoToStep:o})=>{return r.a.createElement(l.Fragment,null,r.a.createElement(Q.a,{item:!0,xs:12,className:e.gridTitle},r.a.createElement("div",{className:e.titleContainer},r.a.createElement(ie.a,{variant:"h6",className:e.title},t)),r.a.createElement(de.a,{classes:{root:e.stepper},nonLinear:!0,activeStep:n},a.map((e,t)=>r.a.createElement(ue.a,{key:e},r.a.createElement(he.a,{onClick:(e=>()=>o(e))(t),disabled:null==s[t],completed:s[t]},e))))),r.a.createElement(Q.a,{item:!0,xs:12,className:e.stepTitle},r.a.createElement(ie.a,{variant:"h5"},`Step ${n+1}: ${a[n]}`)))});const ge=["Source","Columns","Constraints","Summary"];var Ce=Object(L.connect)(null,e=>({dispatchGoToStep:t=>e(Object(se.j)(t))}))(class extends l.Component{render(){const{currentStep:e,completedSteps:t,dispatchGoToStep:a}=this.props;return r.a.createElement(be,{title:"Configure Query",stepLabels:ge,currentStep:e,completedSteps:t,dispatchGoToStep:a})}}),Ee=a("./src/workbench/actions.ts"),ve=a("./node_modules/react-virtualized/dist/es/index.js"),ye=a("./node_modules/@material-ui/core/FormControl/index.js"),Ie=a.n(ye),Se=a("./node_modules/@material-ui/core/Input/index.js"),fe=a.n(Se),we=a("./node_modules/@material-ui/core/Menu/index.js"),je=a.n(we),xe=a("./node_modules/@material-ui/core/InputLabel/index.js"),Oe=a.n(xe),Te=a("./node_modules/@material-ui/core/FormHelperText/index.js"),Ne=a.n(Te),ke=a("./node_modules/@material-ui/core/InputAdornment/index.js"),Le=a.n(ke),De=a("./node_modules/@material-ui/core/IconButton/index.js"),Re=a.n(De),Ae=a("./node_modules/@material-ui/core/MenuItem/index.js"),Ve=a.n(Ae),Qe=a("./node_modules/@material-ui/core/ListItemIcon/index.js"),_e=a.n(Qe);var Pe=Object(s.withStyles)(({spacing:{unit:e}})=>Object(s.createStyles)({menuItem:{padding:"0 0 0 10px"},labelContainer:{padding:2*e}}))(({classes:e,style:t,OptionsIcon:a,option:n,handleClick:l})=>r.a.createElement(Ve.a,{component:"div",style:t,className:e.menuItem,onClick:l},a&&r.a.createElement(_e.a,null,r.a.createElement(a,null)),r.a.createElement("div",{className:e.labelContainer},n.label)));var Ue=Object(s.withStyles)(({spacing:{unit:e}})=>Object(s.createStyles)({labelContainer:{padding:2*e}}))(({classes:e})=>r.a.createElement(ie.a,{color:"textSecondary",className:e.labelContainer},"No items found")),Me=a("./node_modules/@material-ui/icons/Clear.js"),Fe=a.n(Me);const qe=()=>r.a.createElement(Ue,null);var We=({containerRef:e,inputLabel:t,helperText:a,label:n,options:l,handleInputClick:s,handleInputChange:o,noClear:i,handleClickClearSelected:c,handleMouseDownPassword:d,anchorEl:m,handleClose:u,handleOptionClick:p,OptionsIcon:h})=>r.a.createElement("div",{ref:e},r.a.createElement(Ie.a,{fullWidth:!0},t&&r.a.createElement(Oe.a,{htmlFor:"select-input"},t),r.a.createElement(fe.a,{fullWidth:!0,value:n,onClick:s,onChange:o,endAdornment:!i&&r.a.createElement(Le.a,{position:"end"},r.a.createElement(Re.a,{"aria-label":"Clear Selected",onClick:c,onMouseDown:d},r.a.createElement(Fe.a,null)))}),r.a.createElement(je.a,{disableAutoFocus:!0,disableAutoFocusItem:!0,disableRestoreFocus:!0,MenuListProps:{component:"div",disablePadding:!0},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},anchorEl:m,open:!!m,onClose:u},e.current&&r.a.createElement(ve.b,{width:e.current.offsetWidth,height:0===l.length?45:Math.min(40*l.length,300),rowCount:l.length,rowHeight:40,rowRenderer:((e,t,a)=>({index:n,key:l,style:s})=>{const o=e[n],i=t(o);return r.a.createElement(Pe,{key:l,style:s,option:o,handleClick:i,OptionsIcon:a})})(l,p,h),noRowsRenderer:qe})),a&&r.a.createElement(Ne.a,null,a)));class Be extends r.a.Component{constructor(e){super(e),this.containerRef=r.a.createRef(),this.handleMouseDownPassword=(e=>{e.preventDefault()}),this.handleClickClearSelected=(()=>{this.setState({options:[...this.props.options],label:"",anchorEl:void 0})}),this.handleInputClick=(e=>{this.setState({options:[...this.props.options],anchorEl:e.currentTarget})}),this.handleInputChange=(e=>{this.setState({options:this.props.options.filter(({label:t})=>t.toUpperCase().includes(e.target.value.toUpperCase())),label:e.target.value})}),this.handleOptionClick=(e=>t=>{this.setState({label:null!=this.props.value?e.label:"",anchorEl:void 0}),this.props.handleChange(e)}),this.handleClose=(()=>{this.setState({anchorEl:void 0})});const t=e.value&&this.props.options.find(({value:t})=>t===e.value);this.state={anchorEl:void 0,label:t&&t.label||"",options:[...this.props.options]}}render(){const{OptionsIcon:e,inputLabel:t,helperText:a,noClear:n}=this.props,{anchorEl:l,label:s,options:o}=this.state;return r.a.createElement(We,{label:s,containerRef:this.containerRef,anchorEl:l,options:o,handleOptionClick:this.handleOptionClick,handleInputClick:this.handleInputClick,handleInputChange:this.handleInputChange,handleClickClearSelected:this.handleClickClearSelected,handleMouseDownPassword:this.handleMouseDownPassword,handleClose:this.handleClose,OptionsIcon:e,inputLabel:t,helperText:a,noClear:n})}}var ze=a("./node_modules/@material-ui/icons/Storage.js"),He=a.n(ze);const Ge=Object(s.createStyles)({iconColour:{fill:"#003b86"}}),Xe=Object(s.withStyles)(Ge)(({classes:e})=>r.a.createElement(He.a,{className:e.iconColour}));var Ye=({targetDataViewId:e,dataServices:t,handleChangeDataService:a})=>r.a.createElement(Be,{OptionsIcon:Xe,inputLabel:"Click here to select a source...",value:e,options:t,handleChange:a});var $e=Object(L.connect)(e=>({dataServices:U(e)}),e=>({dispatchDataServicesRequest:()=>e(Object(se.f)()),dispatchUpdateDataService:(t,a)=>e(Object(Ee.r)(t,a))}))(class extends l.Component{constructor(){super(...arguments),this.handleChangeDataService=(e=>{const{elementId:t,dispatchUpdateDataService:a}=this.props;a(t,e.value)})}componentDidMount(){this.props.dispatchDataServicesRequest()}render(){const{targetDataViewId:e,dataServices:t}=this.props;return r.a.createElement(Ye,{targetDataViewId:e,dataServices:t,handleChangeDataService:this.handleChangeDataService})}}),Ke=a("./node_modules/@material-ui/core/List/index.js"),Je=a.n(Ke),Ze=a("./node_modules/@material-ui/core/ListItem/index.js"),et=a.n(Ze),tt=a("./node_modules/@material-ui/core/ListItemText/index.js"),at=a.n(tt),nt=a("./node_modules/@material-ui/icons/SettingsApplications.js"),lt=a.n(nt);const rt=Object(s.createStyles)({iconColour:{fill:"#003b86"},listItem:{paddingLeft:15},listItemText:{display:"flex"},listItemTextPrimary:{flexBasis:"35%"}});var st=Object(s.withStyles)(rt)(({classes:e,style:t,option:a,handleClick:n})=>r.a.createElement(et.a,{divider:!0,style:t,onClick:n,disableGutters:!0,dense:!0,button:!0,className:e.listItem,ContainerComponent:"div"},r.a.createElement(_e.a,null,r.a.createElement(lt.a,{className:e.iconColour})),r.a.createElement(at.a,{classes:{primary:e.listItemTextPrimary},className:e.listItemText,primary:a.label})));const ot=Object(s.createStyles)({list:{height:"100%"},paper:{padding:10}}),it=()=>r.a.createElement(Ue,null);var ct=Object(s.withStyles)(ot)(({classes:e,label:t,totItems:a,searchableItems:n,searchString:l,handleItemClick:s,handleChange:o,handleClickClearIcon:i})=>r.a.createElement(c.a,{className:e.paper},r.a.createElement(ie.a,{variant:"subtitle1"},`${t} (${a})`),r.a.createElement(Je.a,{className:e.list,component:"div",disablePadding:!0},r.a.createElement(Ie.a,{fullWidth:!0},r.a.createElement(Oe.a,null,"Search"),r.a.createElement(fe.a,{value:l,onChange:o,disabled:0===n.length,endAdornment:r.a.createElement(Le.a,{position:"end"},r.a.createElement(Re.a,{"aria-label":"Clear",onClick:i,onMouseDown:i},l?r.a.createElement(Fe.a,null):null))})),r.a.createElement(ve.a,{disableHeight:!0},({width:e})=>r.a.createElement(ve.b,{width:e,height:245,rowCount:n.length,rowHeight:41,rowRenderer:((e,t)=>({index:a,key:n,style:l})=>{const s=e[a],o=t(s);return r.a.createElement(st,{key:n,style:l,option:s,handleClick:o})})(n,s),noRowsRenderer:it})))));const dt=e=>e.searchString,mt=(e,t)=>t.items;class ut extends l.Component{constructor(){super(...arguments),this.state={searchString:""},this.filterList=Object(D.a)(dt,mt,(e,t)=>t.filter(t=>t.label.includes(e))),this.handleClickClearIcon=(()=>{this.setState({searchString:""})}),this.handleChange=(e=>{this.setState({searchString:e.target.value})})}render(){const{label:e,handleItemClick:t}=this.props,{searchString:a}=this.state,n=this.filterList(this.state,this.props);return r.a.createElement(ct,{label:e,totItems:n.length,searchableItems:n,searchString:a,handleItemClick:t,handleChange:this.handleChange,handleClickClearIcon:this.handleClickClearIcon})}}var pt=a("./node_modules/@material-ui/icons/KeyboardArrowLeft.js"),ht=a.n(pt),bt=a("./node_modules/@material-ui/icons/KeyboardArrowRight.js"),gt=a.n(bt);var Ct=Object(s.withStyles)(({spacing:{unit:e}})=>Object(s.createStyles)({listContainer:{position:"relative"},button:{position:"absolute",right:2*e,top:2*e}}))(({classes:e,availableColumns:t,selectedColumns:a,handleAddQueryColumn:n,handleRemoveQueryColumn:l})=>r.a.createElement(Q.a,{container:!0,spacing:16},r.a.createElement(Q.a,{item:!0,xs:6,className:e.listContainer},t.length>0&&r.a.createElement(p.a,{variant:"outlined",color:"secondary",size:"small",className:e.button},"Add All Columns",r.a.createElement(gt.a,null)),r.a.createElement(ut,{label:"Available Columns",items:t,handleItemClick:n})),r.a.createElement(Q.a,{item:!0,xs:6,className:e.listContainer},a.length>0&&r.a.createElement(p.a,{variant:"outlined",size:"small",className:e.button},r.a.createElement(ht.a,null),"Remove All Columns"),r.a.createElement(ut,{label:"Selected Columns",items:a,handleItemClick:l}))));const Et=e=>e.availableColumns,vt=e=>e.selectedColumns;var yt=Object(L.connect)(e=>({availableColumns:W(e),selectedColumns:z(e)}),e=>({dispatchAddQueryColumn:(t,a)=>e(Object(Ee.h)(t,a)),dispatchRemoveQueryColumn:(t,a)=>e(Object(Ee.l)(t,a))}))(class extends l.Component{constructor(){super(...arguments),this.availableColumnOptions=Object(D.a)(Et,e=>e.map(e=>({label:e.Label,value:e.ColumnName}))),this.selectedColumnOptions=Object(D.a)(vt,e=>e.map(e=>({label:e.Label,value:e.ColumnName}))),this.handleAddQueryColumn=(({value:e,label:t})=>a=>{const{elementId:n,dispatchAddQueryColumn:l}=this.props;l(n,{ColumnName:e,Label:t,Aggregation:"None"})}),this.handleRemoveQueryColumn=(({value:e})=>t=>{const{elementId:a,dispatchRemoveQueryColumn:n}=this.props;n(a,e)})}render(){return r.a.createElement(Ct,{availableColumns:this.availableColumnOptions(this.props),selectedColumns:this.selectedColumnOptions(this.props),handleAddQueryColumn:this.handleAddQueryColumn,handleRemoveQueryColumn:this.handleRemoveQueryColumn})}}),It=a("./node_modules/@material-ui/core/Select/index.js"),St=a.n(It),ft=a("./node_modules/@material-ui/icons/FilterList.js"),wt=a.n(ft),jt=a("./node_modules/@material-ui/icons/Delete.js"),xt=a.n(jt);var Ot=Object(s.withStyles)(({spacing:{unit:e}})=>Object(s.createStyles)({constraintTargetSelect:{marginBottom:30},constraintIconColour:{fill:"#2c5367"},paper:{display:"flex",alignItems:"center"},targetLabel:{flexBasis:`${2*e}%`,margin:e},typeSelect:{flexBasis:`${2*e}%`,margin:e},valueInput:{flexGrow:1,margin:e},constraintIcon:{margin:e,fill:"#2c5367"}}))(({classes:e,availableConstraintsObj:{availableConstraints:t,columnsDic:a,filtersDic:n},queryConstraints:s,filterCapabilities:o,handledAddQueryConstraint:i,handledUpdateQueryConstraintType:d,handledUpdateQueryConstraintValues:m,handledRemoveQueryConstraint:u})=>r.a.createElement(l.Fragment,null,r.a.createElement("div",{className:e.constraintTargetSelect},r.a.createElement(Be,{OptionsIcon:wt.a,inputLabel:"Contraint on...",options:t,handleChange:i})),s.length>0&&s.map(({ConstraintId:t,DataType:l,FilterType:s,FilterName:i,ColumnName:p})=>r.a.createElement(c.a,{key:t,className:e.paper},r.a.createElement(wt.a,{className:e.constraintIcon}),r.a.createElement(ie.a,{variant:"subtitle1",className:e.targetLabel},((e,t)=>e&&e.Label||t&&t.Label)(a[p],n[i])),r.a.createElement(Ie.a,{className:e.typeSelect},r.a.createElement(St.a,{value:s,onChange:d(t),autoWidth:!0},o[l].map(({Type:e,Label:t},a)=>r.a.createElement(Ve.a,{key:a,value:e},t)))),r.a.createElement(Ie.a,{className:e.valueInput},r.a.createElement(fe.a,{autoFocus:!0,value:"",onChange:m(t,l)})),r.a.createElement(Re.a,{"aria-label":"Delete",onClick:u(t)},r.a.createElement(xt.a,null))))));var Tt=Object(L.connect)(e=>({queryConstraints:Y(e),filterCapabilities:e.queryConfigReducer.filterCapabilities,availableConstraintsObj:X(e)}),e=>({dispatchFilterCapabilitiesRequest:()=>e(Object(se.h)()),dispatchAddQueryConstraint:(t,a)=>e(Object(Ee.i)(t,a)),dispatchUpdateQueryConstraintType:(t,a,n)=>e(Object(Ee.p)(t,a,n)),dispatchUpdateQueryConstraintValues:(t,a,n)=>e(Object(Ee.q)(t,a,n)),dispatchRemoveQueryConstraint:(t,a)=>e(Object(Ee.m)(t,a))}))(class extends l.Component{constructor(){super(...arguments),this.handledAddQueryConstraint=(e=>{const{elementId:t,queryConstraints:a,dispatchAddQueryConstraint:n,filterCapabilities:l,availableConstraintsObj:{columnsDic:r,filtersDic:s}}=this.props,o=r[e.value],i=s[e.value],c=o&&o.DataType||i&&i.DataType,d=o&&o.ColumnName||i&&i.ToColumnName;n(t,{ConstraintId:a.length,ConstraintName:o&&o.ColumnName,FilterName:i&&i.FilterName,DataType:c,ColumnName:d,FilterType:l[c][0].Type})}),this.handledUpdateQueryConstraintType=(e=>t=>{const{elementId:a,dispatchUpdateQueryConstraintType:n}=this.props;n(a,e,t.target.value)}),this.handledUpdateQueryConstraintValues=((e,t)=>a=>{const{elementId:l,dispatchUpdateQueryConstraintValues:r}=this.props,s=function(e,t,a){const l={vectorValues:[[t]],valuesHint:"NoHint"};switch(e){case n.INTERVALVALUE:l.vectorValues=[[t.intervalType,t.intervalString,t.intervalLabel]];break;case n.SELECT:case n.TEXTINPUTLIST:case n.MULTISELECT:l.vectorValues=t.values,l.valuesHint=a}return l}(t,a.target.value);r(l,e,s.vectorValues)}),this.handledRemoveQueryConstraint=(e=>()=>{const{elementId:t,dispatchRemoveQueryConstraint:a}=this.props;a(t,e)})}componentDidMount(){this.props.dispatchFilterCapabilitiesRequest()}render(){const{queryConstraints:e,filterCapabilities:t,availableConstraintsObj:a}=this.props;return r.a.createElement(Ot,{queryConstraints:e,filterCapabilities:t,availableConstraintsObj:a,handledAddQueryConstraint:this.handledAddQueryConstraint,handledUpdateQueryConstraintType:this.handledUpdateQueryConstraintType,handledUpdateQueryConstraintValues:this.handledUpdateQueryConstraintValues,handledRemoveQueryConstraint:this.handledRemoveQueryConstraint})}});var Nt=Object(s.withStyles)(({spacing:{unit:e}})=>Object(s.createStyles)({actionButtons:{display:"flex",justifyContent:"flex-end",position:"fixed",bottom:6*e,right:0},button:{margin:e}}))(({classes:e,currentStep:t,completedSteps:a,dispatchCloseConfig:n,dispatchGoToStep:l})=>{const s=e=>()=>l(e);return r.a.createElement(Q.a,{item:!0,xs:12,className:e.actionButtons},r.a.createElement(p.a,{onClick:n,variant:"contained",className:e.button},"Close"),r.a.createElement(p.a,{disabled:0===t,onClick:s(t-1),variant:"contained",color:"secondary",className:e.button},"Back"),r.a.createElement(p.a,{disabled:!a[t],onClick:s(t+1),variant:"contained",color:"secondary",className:e.button},"Next"))});var kt=Object(L.connect)(null,e=>({dispatchGoToStep:t=>e(Object(se.j)(t)),dispatchCloseQueryConfig:()=>e(Object(se.e)())}))(class extends l.Component{render(){const{currentStep:e,completedSteps:t,dispatchCloseQueryConfig:a,dispatchGoToStep:n}=this.props;return r.a.createElement(Nt,{currentStep:e,completedSteps:t,dispatchCloseConfig:a,dispatchGoToStep:n})}});var Lt=({isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n})=>r.a.createElement($.a,{isLoading:e},r.a.createElement(Ce,{currentStep:a,completedSteps:n}),r.a.createElement(re,{currentStep:a}),r.a.createElement(Q.a,{item:!0,xs:12},function(e,t){if(null==t.TargetDataViewId)throw new Error("TargetDataViewId cannot be null.");switch(e){case 0:return r.a.createElement($e,{elementId:t.ElementId,targetDataViewId:t.TargetDataViewId});case 1:return r.a.createElement(yt,{elementId:t.ElementId});case 2:return r.a.createElement(Tt,{elementId:t.ElementId});default:return"Unknown step"}}(a,t)),r.a.createElement(kt,{currentStep:a,completedSteps:n}));var Dt=Object(L.connect)(e=>({isLoading:e.queryConfigReducer.isLoading,selectedQuery:B(e),currentStep:e.queryConfigReducer.currentStep,completedSteps:H(e)}))(class extends l.Component{render(){const{isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n}=this.props;return r.a.createElement(Lt,{isLoading:e,selectedQuery:t,currentStep:a,completedSteps:n})}});var Rt=Object(s.withStyles)(({spacing:e})=>Object(s.createStyles)({paper:{width:"85%",marginTop:48},form:{position:"relative",height:"100%",padding:2*e.unit,overflow:"auto",marginBottom:48}}))(({classes:e,elementType:t,isDrawerOpen:a})=>r.a.createElement(P.a,{classes:{paper:e.paper},anchor:"right",open:a},a&&r.a.createElement("form",{className:e.form,noValidate:!0,autoComplete:"off"},r.a.createElement(Q.a,{container:!0,spacing:16,alignContent:"stretch"},(e=>{switch(e){case R.b.QUERY:return r.a.createElement(Dt,null);case R.b.FILTER:return"TODO";default:return null}})(t)))));var At=Object(L.connect)(e=>({elementType:e.configSwitchReducer.elementType,isDrawerOpen:A(e)}))(class extends l.Component{render(){return r.a.createElement(Rt,Object.assign({},this.props))}}),Vt=(a("./node_modules/storm-react-diagrams/dist/style.min.css"),a("./node_modules/storm-react-diagrams/dist/main.js"));class Qt extends Vt.AbstractPortFactory{constructor(e){super("workbench"),this.portModel=e}getNewInstance(e){return this.portModel}}class _t extends Vt.PortModel{constructor(e="from"){super(e,"workbench"),this.position=e}serialize(){return Object.assign(super.serialize(),{position:this.position})}deSerialize(e,t){super.deSerialize(e,t),this.position=e.position}link(e){const t=this.createLinkModel();return t.setSourcePort(this),t.setTargetPort(e),t}createLinkModel(){return new Vt.DefaultLinkModel}}const Pt=Object(s.createStyles)({listItem:{padding:0},itemIcon:{marginRight:5},primary:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});var Ut=Object(s.withStyles)(Pt)(({classes:e,style:t,label:a})=>r.a.createElement(et.a,{style:t,className:e.listItem,component:"div",dense:!0},r.a.createElement(_e.a,{className:e.itemIcon},r.a.createElement(lt.a,null)),r.a.createElement(at.a,{className:e.listItem,classes:{primary:e.primary},primary:a}))),Mt=a("./node_modules/@material-ui/core/Divider/index.js"),Ft=a.n(Mt);const qt=e=>{e.stopPropagation()};var Wt=Object(s.withStyles)(({palette:{background:{paper:e}}})=>Object(s.createStyles)({container:{display:"flex",alignItems:"center",justifyContent:"center"},operatorContainer:{display:"flex",flexFlow:"column",alignItems:"center",borderRadius:5,border:"1px solid #7b582d",padding:"0px 5px 0px 5px",width:165,backgroundColor:e},titleContainer:{width:"100%",display:"flex",alignItems:"center",marginBottom:5},avatar:{marginRight:10,width:25,height:25},list:{overflow:"auto",padding:0,width:150,marginTop:3,cursor:"default","&:focus":{outline:0}},listItem:{padding:0},itemIcon:{width:10,height:10,marginRight:5},primary:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},topPort:{position:"relative",top:-9,backgroundColor:"#ccc",zIndex:-1},bottomPort:{position:"relative",top:9,backgroundColor:"#ccc",borderRadius:15,zIndex:-1}}))(({classes:e,node:t})=>{const{Label:a,Columns:n}=t.getQueryInfo(),{backgroundColor:l,IconComponent:s}=R.c.QUERY;return r.a.createElement("div",{className:e.container},r.a.createElement("div",{className:e.operatorContainer},r.a.createElement("div",{className:e.topPort},r.a.createElement(Vt.PortWidget,{name:"to",node:t})),r.a.createElement("div",{className:e.titleContainer},r.a.createElement(ae.a,{className:e.avatar,style:{backgroundColor:l}},r.a.createElement(s)),r.a.createElement(ie.a,{variant:"subtitle1",noWrap:!0},a)),r.a.createElement("div",null,r.a.createElement(ie.a,{noWrap:!0},"Columns"),r.a.createElement(Ft.a,null),r.a.createElement(Je.a,{className:e.list,onWheel:qt,component:"div"},r.a.createElement(ve.a,{disableHeight:!0},({width:e})=>r.a.createElement(ve.b,{style:{outline:0},width:e,height:Math.min(20*n.length,150),rowCount:n.length,rowHeight:20,rowRenderer:(e=>({index:t,key:a,style:n})=>r.a.createElement(Ut,{key:a,style:n,label:e[t].Label}))(n)})))),r.a.createElement("div",{className:e.bottomPort},r.a.createElement(Vt.PortWidget,{name:"from",node:t}))))});class Bt extends Vt.AbstractNodeFactory{constructor(){super("query")}generateReactWidget(e,t){return r.a.createElement(Wt,{node:t})}getNewInstance(){return new Vt.NodeModel}}class zt extends Vt.NodeModel{constructor(e){super("query",e.ElementId.toString()),this.addPort(new _t("from")),this.addPort(new _t("to")),this.setPosition(e.LayoutX,e.LayoutY),this.queryInfo=e}getQueryInfo(){return this.queryInfo}}var Ht=Object(s.withStyles)(({palette:{background:{paper:e}}})=>Object(s.createStyles)({container:{display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center",borderRadius:"0px 0px 80px 80px",border:"1px solid #2c5367",width:155,height:85,backgroundColor:e},body:{display:"flex",maxWidth:130,marginBottom:5},avatar:{width:25,height:25,marginRight:3},label:{marginTop:10},filterType:{textAlign:"center"},topPort:{position:"relative",top:-11,backgroundColor:"#ccc",zIndex:-1},bottomPort:{position:"relative",top:11,backgroundColor:"#ccc",borderRadius:15,zIndex:-1}}))(({classes:e,node:t})=>{const{Label:a,FilterType:n}=t.getFilterInfo(),{backgroundColor:l,IconComponent:s}=R.c.FILTER;return r.a.createElement("div",{className:e.container},r.a.createElement("div",{className:e.topPort},r.a.createElement(Vt.PortWidget,{name:"to",node:t})),r.a.createElement("div",{className:e.body},r.a.createElement(ae.a,{className:e.avatar,style:{backgroundColor:l}},r.a.createElement(s)),r.a.createElement(ie.a,{variant:"subtitle1",noWrap:!0},a)),r.a.createElement(ie.a,{className:e.filterType,noWrap:!0},n),r.a.createElement("div",{className:e.bottomPort},r.a.createElement(Vt.PortWidget,{name:"from",node:t})))});class Gt extends Vt.AbstractNodeFactory{constructor(){super("filter")}generateReactWidget(e,t){return r.a.createElement(Ht,{node:t})}getNewInstance(){return new Vt.NodeModel}}class Xt extends Vt.NodeModel{constructor(e){super("filter",e.ElementId.toString()),this.addPort(new _t("from")),this.addPort(new _t("to")),this.setPosition(e.LayoutX,e.LayoutY),this.filterInfo=e}getFilterInfo(){return this.filterInfo}}const Yt=Object(s.createStyles)({canvasContainer:{height:"100%",width:"100%"},canvas:{height:"100%",width:"100%"}});var $t=Object(s.withStyles)(Yt)(({classes:e,diagramEngine:t,handleDragOver:a,handleDrop:n})=>r.a.createElement("div",{className:e.canvasContainer,onDrop:n,onDragOver:a},r.a.createElement(Vt.DiagramWidget,{className:e.canvas,diagramEngine:t,maxNumberPointsPerLink:0,allowLooseLinks:!1}))),Kt=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&(a[n[l]]=e[n[l]])}return a};var Jt=Object(L.connect)(e=>{return Kt(e.sessionReducer,[])},e=>({dispatchSessionRequest:t=>{e(Object(Ee.n)(t))},dispatchAddQuery:(t,a,n)=>e(Object(Ee.g)(t,a,n))}))(class extends l.Component{constructor(e){super(e),this.handleDragOver=(e=>{e.preventDefault()}),this.handleDrop=(e=>{const{graph:t,dispatchAddQuery:a}=this.props;if(null==t)throw new Error("Graph cannot be null.");const n=e.dataTransfer.getData("ELEMENT"),l=this.diagramEngine.getRelativeMousePoint(e);switch(n){case R.b.QUERY:a(t.NextElementId,l.x,l.y)}}),this.diagramEngine=new Vt.DiagramEngine,this.diagramEngine.installDefaultFactories(),this.diagramEngine.registerPortFactory(new Qt(new _t)),this.diagramEngine.registerNodeFactory(new Bt),this.diagramEngine.registerNodeFactory(new Gt),this.activeModel=new Vt.DiagramModel,this.diagramEngine.setDiagramModel(this.activeModel)}componentDidMount(){const{match:e}=this.props,t="new"===e.params.id?void 0:e.params.id;this.props.dispatchSessionRequest(t)}componentDidUpdate(e){const t=this.props.session;if(null==t)return;const a=e.session;if(null==a||t.SessionId!==a.SessionId){const e=Object.keys(this.props.queries).map(e=>new zt(this.props.queries[e])),t=Object.keys(this.props.filters).map(e=>new Xt(this.props.filters[e]));this.activeModel.addAll(...e),this.activeModel.addAll(...t);const a=[];for(const e of Object.keys(this.props.connections)){const t=this.props.connections[e],n=this.activeModel.getNode(t.FromElementId.toString()),l=this.activeModel.getNode(t.ToElementId.toString());if(null==n||null==l)return;const r=n.getPort("from"),s=l.getPort("to"),o=r.link(s);a.push(o)}this.activeModel.addAll(...a)}}render(){const{isLoading:e}=this.props;return r.a.createElement($.c,{isLoading:e},r.a.createElement($t,{diagramEngine:this.diagramEngine,handleDragOver:this.handleDragOver,handleDrop:this.handleDrop}))}});const Zt=Object(s.createStyles)({workbench:{height:"100%",width:"100%",border:"3px solid #ccc",backgroundColor:"#ccc"},canvasContainer:{borderRadius:5,height:"100%",width:"100%",backgroundColor:"#3c3c3c",backgroundImage:"linear-gradient(\n      0deg,\n      transparent 24%,\n      rgba(255, 255, 255, 0.05) 25%,\n      rgba(255, 255, 255, 0.05) 26%,\n      transparent 27%,\n      transparent 74%,\n      rgba(255, 255, 255, 0.05) 75%,\n      rgba(255, 255, 255, 0.05) 76%,\n      transparent 77%,\n      transparent\n    ),\n    linear-gradient(\n      90deg,\n      transparent 24%,\n      rgba(255, 255, 255, 0.05) 25%,\n      rgba(255, 255, 255, 0.05) 26%,\n      transparent 27%,\n      transparent 74%,\n      rgba(255, 255, 255, 0.05) 75%,\n      rgba(255, 255, 255, 0.05) 76%,\n      transparent 77%,\n      transparent\n    )",backgroundSize:"50px 50px"}});t.default=Object(s.withStyles)(Zt)(({classes:e,match:t})=>r.a.createElement("div",{className:e.workbench},r.a.createElement(k,null),r.a.createElement(At,null),r.a.createElement("div",{className:e.canvasContainer},r.a.createElement(Jt,{match:t}))))}}]);
//# sourceMappingURL=6.bundle.js.map